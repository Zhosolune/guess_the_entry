# 需求文档

## 介绍

开发一个网页互动文字猜词游戏，玩家通过输入单个汉字来逐步揭示被遮盖的百科内容，最终猜出词条名称。游戏集成了DeepSeek API用于生成词条和百科内容，支持多领域选择和完整的游戏流程管理。

## 需求

### 需求 1 - 词条选择与生成

**用户故事：** 作为玩家，我希望能够选择不同领域的词条进行游戏，以便根据自己的兴趣进行挑战

#### 验收标准

1. When 玩家进入游戏首页时，the 系统 shall 显示领域选择界面，包含自然、天文、地理、动漫、影视、游戏、体育、历史、ACGN等选项以及随机选择按钮
2. When 玩家选择特定领域或随机后点击开始时，the 系统 shall 通过Cloudflare代理调用DeepSeek API生成对应领域的词条和百科内容
3. While 词条生成过程中，the 系统 shall 显示加载状态提示
4. When 词条生成失败时，the 系统 shall 显示错误提示并提供重试选项

### 需求 2 - 游戏界面与遮盖机制

**用户故事：** 作为玩家，我希望能够看到被遮盖的百科内容，并通过猜测来逐步揭示文字

#### 验收标准

1. When 游戏开始时，the 系统 shall 显示词条名称（完全遮盖）和百科内容（每个文字单独遮盖）
2. While 游戏进行中，the 系统 shall 使用灰色方块遮盖所有文字，仅显示文字长度
3. When 玩家输入单个汉字并确认后，the 系统 shall 检查该字是否存在于百科内容中
4. When 输入的汉字存在于内容中时，the 系统 shall 移除该字在所有出现位置的遮盖
5. When 输入的汉字不存在于内容中时，the 系统 shall 将该字添加到坟场区域

### 需求 3 - 坟场区域管理

**用户故事：** 作为玩家，我希望能够看到所有错误的猜测，以便排除已尝试的字

#### 验收标准

1. While 游戏进行中，the 系统 shall 在界面一侧显示坟场区域
2. When 玩家输入错误的汉字时，the 系统 shall 将该字添加到坟场列表
3. While 坟场显示时，the 系统 shall 按输入时间顺序排列错误汉字
4. When 坟场区域超过可视范围时，the 系统 shall 提供滚动功能

### 需求 4 - 游戏计时与计数

**用户故事：** 作为玩家，我希望能够了解自己的游戏表现，包括用时和尝试次数

#### 验收标准

1. When 游戏开始时，the 系统 shall 启动计时器显示游戏进行时间
2. While 游戏进行中，the 系统 shall 实时更新计时器显示（秒级更新）
3. When 玩家每次输入猜测时，the 系统 shall 增加尝试次数计数
4. When 游戏结束时，the 系统 shall 显示总用时和总尝试次数
5. While 游戏暂停时，the 系统 shall 暂停计时器但不重置计数

### 需求 5 - 胜利判定与游戏结束

**用户故事：** 作为玩家，我希望能够在猜出词条时得到胜利反馈，并可以选择重新开始

#### 验收标准

1. While 游戏进行中，the 系统 shall 提供"我已知道答案"按钮
2. When 玩家点击"我已知道答案"时，the 系统 shall 弹出输入框让玩家输入词条名称
3. When 玩家输入词条名称时，the 系统 shall 进行不区分大小写的匹配验证
4. When 词条猜测正确时，the 系统 shall 显示胜利界面，包含用时、尝试次数和重新开始按钮
5. When 词条猜测错误时，the 系统 shall 显示提示并继续游戏
6. When 游戏胜利时，the 系统 shall 停止计时并记录游戏统计数据

### 需求 6 - DeepSeek API集成

**用户故事：** 作为系统，我需要通过Cloudflare代理调用DeepSeek API来生成游戏内容

#### 验收标准

1. While 生成词条时，the 系统 shall 通过Cloudflare Worker代理调用DeepSeek API
2. When 调用API时，the 系统 shall 发送包含领域信息的prompt
3. When API返回响应时，the 系统 shall 解析JSON格式的词条和百科内容
4. While 处理API响应时，the 系统 shall 确保内容符合中文语境和游戏长度要求
5. When API调用失败时，the 系统 shall 实现重试机制和降级方案

### 需求 7 - 响应式界面设计

**用户故事：** 作为玩家，我希望能够在不同设备上流畅地进行游戏

#### 验收标准

1. While 游戏界面显示时，the 系统 shall 采用响应式设计适配不同屏幕尺寸
2. When 在桌面设备上时，the 系统 shall 显示为左右布局（内容区域和坟场区域并排）
3. When 在移动设备上时，the 系统 shall 显示为上下布局（坟场区域在下方）
4. While 界面交互时，the 系统 shall 提供清晰的视觉反馈和交互动画
5. When 输入汉字时，the 系统 shall 提供输入法友好的输入框设计

### 需求 8 - 游戏状态管理

**用户故事：** 作为玩家，我希望游戏状态能够正确管理，避免刷新丢失进度

#### 验收标准

1. While 游戏进行中时，the 系统 shall 在本地存储中保存游戏状态
2. When 页面刷新时，the 系统 shall 恢复当前游戏进度（如果存在）
3. When 游戏胜利或玩家选择新游戏时，the 系统 shall 清除之前的游戏状态
4. While 状态管理时，the 系统 shall 确保数据完整性和一致性